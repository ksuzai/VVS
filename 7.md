### Приближённая оценка сумм при помощи интегралов

Один из мощных методов анализа сумм в математике — их приближённая оценка с помощью интегралов. Этот подход особенно полезен, когда нужно оценить сумму большого числа слагаемых, например, в асимптотическом анализе или при работе с рядами.

#### 1. Основная идея: связь сумм и интегралов

Рассмотрим сумму вида:
$$S(n) = \sum_{k=1}^{n} f(k),$$
где $f$ — некоторая функция. Если $f$ монотонна (возрастает или убывает), то её можно сравнить с интегралом от $f$.

**Геометрическая интерпретация:**
- Если $f$ **возрастает**, то площадь под кривой $f(x)$ на отрезке \([1, n+1]\) можно оценить ступенчатыми фигурами, соответствующими слагаемым суммы.
- Если $f$ **убывает**, аналогичные оценки работают, но с поправками.

#### 2. Оценка суммы интегралами снизу и сверху

**Случай монотонно возрастающей функции $f$:**
$$\int_{0}^{n} f(x) \, dx \leq \sum_{k=1}^{n} f(k) \leq \int_{1}^{n+1} f(x) \, dx.$$
*Пояснение:*
- Левое неравенство: прямоугольники суммы $\sum f(k)$ "накрывают" интеграл от $0$ до $n$.
- Правое неравенство: прямоугольники суммы $\sum f(k)$ вписаны в интеграл от $1$ до $n+1$.

**Случай монотонно убывающей функции $f$:**
$$\int_{1}^{n+1} f(x) \, dx \leq \sum_{k=1}^{n} f(k) \leq \int_{0}^{n} f(x) \, dx.$$
*Пояснение:*
- Теперь прямоугольники суммы $\sum f(k)$ для убывающей функции дают обратные неравенства.

#### 3. Пример: оценка гармонической суммы

Гармоническая сумма:
$$H_n = \sum_{k=1}^{n} \frac{1}{k}.$$
Функция $f(x) = \frac{1}{x}$ убывает на $[1, \infty)$, поэтому применяем оценку для убывающей функции:
$$\int_{1}^{n+1} \frac{1}{x} \, dx \leq H_n \leq 1 + \int_{1}^{n} \frac{1}{x} \, dx.$$
Вычисляем интегралы:
$$\ln(n+1) \leq H_n \leq 1 + \ln(n).$$
Таким образом, $H_n \approx \ln(n)$ с точностью до константы.

#### 4. Уточнение оценки (метод Эйлера-Маклорена)

Для более точной оценки можно использовать формулу Эйлера-Маклорена:
$$\sum_{k=1}^{n} f(k) = \int_{1}^{n} f(x) \, dx + \frac{f(1) + f(n)}{2} + \frac{B_2}{2!}(f'(n) - f'(1)) + \dots,$$
где $B_2, B_4, \dots$ — числа Бернулли.

**Применение к гармонической сумме:**
$$H_n = \ln(n) + \gamma + \frac{1}{2n} - \frac{1}{12n^2} + O\left(\frac{1}{n^4}\right),$$
где $\gamma$ — постоянная Эйлера-Маскерони (~0.5772).

#### 5. Другой пример: сумма квадратов

Рассмотрим сумму:
$$S(n) = \sum_{k=1}^{n} k^2.$$
Функция $f(x) = x^2$ возрастает, поэтому:
$$\int_{0}^{n} x^2 \, dx \leq S(n) \leq \int_{1}^{n+1} x^2 \, dx.$$
Вычисляем:
$$\frac{n^3}{3} \leq S(n) \leq \frac{(n+1)^3 - 1}{3}.$$
Известно, что точное значение $S(n) = \frac{n(n+1)(2n+1)}{6}$, что согласуется с оценкой:
$$S(n) \approx \frac{n^3}{3} + \frac{n^2}{2} + \frac{n}{6}.$$

#### 6. Общий подход к уточнению оценки

1. **Оценка грубыми интегралами:** сначала находим верхнюю и нижнюю оценки через интегралы.
2. **Учёт граничных членов:** добавляем поправки на концевые точки.
3. **Разложение в ряд:** используем формулу Эйлера-Маклорена для более точного приближения.
4. **Асимптотический анализ:** находим главный член и поправочные слагаемые.

#### 7. Применение в анализе алгоритмов

Например, для оценки времени работы алгоритма:
$$T(n) = \sum_{k=1}^{n} \log k \approx \int_{1}^{n} \log x \, dx = n \log n - n + O(1).$$
Это даёт известную оценку $\log(n!) \approx n \log n - n$.

#### Заключение

Метод оценки сумм интегралами — это мощный инструмент в асимптотическом анализе. Сначала получаются грубые оценки, затем их можно уточнять, учитывая дополнительные члены. Этот подход широко применяется в теории чисел, анализе алгоритмов и других областях математики.
